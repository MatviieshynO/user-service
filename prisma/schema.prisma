
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             Int      @id @default(autoincrement())
  name           String   @default("")            
  email          String?  @unique                
  phone          String?  @unique                
  password       String                            
  role           UserRole @default(USER)          
  isActive       Boolean  @default(true)        
  isVerified     Boolean  @default(false)   
  avatar         String?        
  settings       Json     @default("{}")   
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  verificationCodes VerificationCode[]
  sessions       Session[]
  logs           Log[]
}

model Session {
  id          Int      @id @default(autoincrement())
  userId      Int
  user        User     @relation(fields: [userId], references: [id])
  refreshToken String  @unique               
  createdAt   DateTime @default(now())       
  expiresAt   DateTime                        
}

model VerificationCode {
  id          Int      @id @default(autoincrement())
  userId      Int
  user        User     @relation(fields: [userId], references: [id])
  type        VerificationType        
  code        String                    
  createdAt   DateTime @default(now())  
  expiresAt   DateTime                  

  @@unique([userId, type])             
}


model Log {
  id          Int      @id @default(autoincrement())
  userId      Int
  user        User     @relation(fields: [userId], references: [id])
  action      String
  ipAddress   String 
  userAgent   String
  createdAt   DateTime @default(now()) 
}

enum VerificationType {
  EMAIL
  PHONE
}

enum UserRole {
  SUPER_ADMIN
  ADMIN
  USER
}